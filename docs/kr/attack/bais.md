# BAIS ( Bluetooth Impersonation AttackS, 블루투스 사칭 공격 )
	

*bleedingbit의 개념 및 원리 등*

- 기기가 롱텀(long-term) 키로 알려진 링크 키를 처리하는 방식에 대한 결함
- 처음 페어링 후 다음부터는 페어링 과정 생략 -> 세션키로 사용할 롱텀 키 (또는 지속 암호화 키(persistent encryption key) ) 설정
	> 자신의 ID를 ‘이전에 연결되었던 기기‘로 속여서 키를 알지 못해도 기기와 인증하고 연결 가능 
   
보통 레거시 시큐어 커넥션즈(Legacy Secure Connections)나 시큐어 커넥션즈(Secure Connections)라는 프로토콜을 통해 두 장비들의 블루투스 주소와 암호화 키를 확인하는데, 
이때 **시큐어 커넥션즈 프로토콜을 통한 연결에서 필요한 정보가 암호화되지도 않고, 무결성을 확인하는 절차를 거치지도 않음. 또한 상호 인증과정을 필요로 하지 않는다.**
   
- 블루투스 장비는 기저 대역의 페이징 후 아무 때나 역할을 변경할 수 있게 된다.
> 역할을 변경할 수 있다. 
> > 1. 블루투스 연결에서는 마스터와 슬레이브 역할 존재 
> > 2. 슬레이브로 연결한 뒤 마스터로 역할변경 가능
- 시큐어 커넥션즈로 연결된 장비들의 경우 안전하게 연결된 상태에서 동시에 레거시 시큐어 커넥션즈 프로토콜을 사용하는 게 가능하다.

	“연구팀은 만약 공격자가 BIAS와 KNOB를 조합한다면 그들은 블루투스 클래식 기기가 안전 인증 모드에서 동작한다고 하더라도 인증을 깰 수 있다고 말한다.”	

두 가지 공격 기법이 합쳐지면 공격자는   
1. 블루투스 장비를 사칭한 후 
2. 아무런 키 없이도 인증 과정을 통과할 수 있게 되고, 
3. 낮은 엔트로피를 가지고 세션 키를 협상할 수 있게 된다. 그런 다음
4. 시큐어 커넥션을 성립시키고 
5. 세션 키에 브루트포스 공격을 가할 수 있게 된다고 한다.   
   
마지막 단계까지 성공시키면 페어링 된 장비(피해자 장비)에 대한 제어권을 가져가거나, 최소한 자신의 장비를 정상적인 장비처럼 네트워크에 연결시킬 수 있게 된다.
## 관련 정보
- CVE
	- CVE-2020-10135
***
- Exploit
***
- Paper
https://francozappa.github.io/about-bias/publication/antonioli-20-bias/antonioli-20-bias.pdf https://francozappa.github.io/talk/wac20/talk/ 